import {Dataset} from "../../src/controller/Dataset";
import {expect, use} from "chai";
import chaiAsPromised from "chai-as-promised";
import {clearDisk, getContentFromArchives} from "../TestUtil";
import {InsightDatasetKind} from "../../src/controller/IInsightFacade";

use(chaiAsPromised);

describe("Dataset", function () {
	let courses: string;

	before(function () {
		courses = getContentFromArchives("coursesSmallQueryExample.zip");
	});

	describe("findCoursesByMComparator", function () {
		let dataset: Dataset;

		beforeEach(function () {
			clearDisk();
			dataset = new Dataset("courses", InsightDatasetKind.Courses);
		});

		it("should search for all courses with avg > a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "avg", 70);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(4);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with avg < a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("lt", "avg", 50);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with avg = a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("eq", "avg", 90);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with pass > a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "pass", 29);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(2);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with pass < a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("lt", "pass", 29);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(6);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with pass = a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("eq", "pass", 29);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with fail > a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "fail", 12);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(4);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with fail < a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("lt", "fail", 12);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(4);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should search for all courses with fail = a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("eq", "fail", 22);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with audit > a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "audit", 9);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(7);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with audit < a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("lt", "audit", 9);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with audit = a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("eq", "audit", 9);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(1);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with year > a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "year", 2015);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with year < a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("lt", "year", 2015);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should search for all courses with year = a number", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("eq", "year", 2015);
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
		it("should return an empty list because nothing satisfies criteria", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesByMComparator("gt", "avg", 101);
				})
				.then((listofCourses) => {
					expect(listofCourses).to.deep.equal([]);
				});
		});
	});

	describe("findCoursesBySComparator", function () {
		let dataset: Dataset;

		beforeEach(function () {
			clearDisk();
			dataset = new Dataset("courses", InsightDatasetKind.Courses);
		});

		it("should search with skey = instructor", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("instructor", "San");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.have.deep.members(expectedCourses);
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
				});
		});

		it("should search with skey = dept", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("dept", "CPSC");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should search with skey = id", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("id", "504");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(6);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should search with skey = uuid", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("uuid", "002");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(3);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should return no results b/c no field matches", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("instructor", "alice");
				})
				.then((listofCourses) => {
					expect(listofCourses).to.deep.equal([]);
				});
		});

		it("should search with a wildcard at the beginning", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("instructor", "*an");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(6);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should search with a wildcard at the end", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.findCoursesBySComparator("uuid", "00*");
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(9);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});
	});

	describe("getAllCourses", function () {
		let dataset: Dataset;

		beforeEach(function () {
			clearDisk();
			dataset = new Dataset("courses", InsightDatasetKind.Courses);
		});

		it("should return all courses", function () {
			return dataset
				.loadDataset(courses)
				.then(() => {
					return dataset.getAllCourses();
				})
				.then((listofCourses) => {
					const expectedCourses = [
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 9,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 9,
							Fail: 1,
							Avg: 70,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 10,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 11,
							Fail: 3,
							Avg: 69,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Intro to Software Engineering",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 8,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2015",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "310",
							Session: "w",
							Pass: 10,
							Fail: 2,
							Avg: 71,
							Campus: "ubc",
							Subject: "cpsc",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 19,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 19,
							Fail: 11,
							Avg: 90,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 20,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 21,
							Fail: 13,
							Avg: 89,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "Atoms and Stuff",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 18,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2014",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 20,
							Fail: 12,
							Avg: 91,
							Campus: "ubc",
							Subject: "phys",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "002",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31379,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "San",
							Audit: 29,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 29,
							Fail: 21,
							Avg: 50,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "001",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Xanotan",
							Audit: 30,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 31,
							Fail: 23,
							Avg: 49,
							Campus: "ubc",
							Subject: "math",
						},
						{
							tier_eighty_five: 1,
							tier_ninety: 8,
							Title: "A Real Analysis of Real Analysis",
							Section: "003",
							Detail: "",
							tier_seventy_two: 0,
							Other: 1,
							Low: 89,
							tier_sixty_four: 0,
							id: 31380,
							tier_sixty_eight: 0,
							tier_zero: 0,
							tier_seventy_six: 0,
							tier_thirty: 0,
							tier_fifty: 0,
							Professor: "Krentas",
							Audit: 28,
							tier_g_fifty: 0,
							tier_forty: 0,
							Withdrew: 1,
							Year: "2016",
							tier_twenty: 0,
							Stddev: 2.65,
							Enrolled: 20,
							tier_fifty_five: 0,
							tier_eighty: 0,
							tier_sixty: 0,
							tier_ten: 0,
							High: 98,
							Course: "504",
							Session: "w",
							Pass: 30,
							Fail: 22,
							Avg: 51,
							Campus: "ubc",
							Subject: "math",
						},
					];
					expect(listofCourses).to.be.an.instanceof(Array);
					expect(listofCourses).to.have.length(9);
					expect(listofCourses).to.have.deep.members(expectedCourses);
				});
		});

		it("should fail because the dataset does not exist", function () {
			return expect(dataset.getAllCourses()).eventually.to.be.rejectedWith(Error);
		});
	});
});
